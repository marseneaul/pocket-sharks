import { getContext } from './canvas.ts';
import { DMG_PALETTE } from '../constants.ts';
import type { NPCSpriteType, Direction } from '../types/overworld.ts';

// NPC sprite data - 16x16 pixel sprites
// . = transparent, # = black outline, @ = dark (clothes/hair), o = light (skin), O = white highlight
// Each NPC type has sprites for 4 directions, 3 frames each (standing, walk1, walk2)

// SWIMMER - wetsuit with snorkel mask
const SWIMMER_SPRITES: Record<string, string[]> = {
  'down_0': [
    '.....####.......',
    '....#@@@@#......',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '...#oO##Oo#.....',
    '...#oooooo#.....',
    '....#oooo#......',
    '....######......',
    '...#@@@@@@#.....',
    '..#@@@@@@@#.....',
    '..#@#@@@@#@#....',
    '...#@@@@@@#.....',
    '...#@@##@@#.....',
    '...#@@##@@#.....',
    '....##..##......',
    '................',
  ],
  'down_1': [
    '.....####.......',
    '....#@@@@#......',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '...#oO##Oo#.....',
    '...#oooooo#.....',
    '....#oooo#......',
    '....######......',
    '...#@@@@@@#.....',
    '..#@@@@@@@#.....',
    '..#@#@@@@#@#....',
    '...#@@@@@@#.....',
    '...#@@##@@#.....',
    '..#@@#..#@@#....',
    '..##......##....',
    '................',
  ],
  'down_2': [
    '.....####.......',
    '....#@@@@#......',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '...#oO##Oo#.....',
    '...#oooooo#.....',
    '....#oooo#......',
    '....######......',
    '...#@@@@@@#.....',
    '..#@@@@@@@#.....',
    '..#@#@@@@#@#....',
    '...#@@@@@@#.....',
    '...#@@##@@#.....',
    '....#@@##@@#....',
    '....##....##....',
    '................',
  ],
  'up_0': [
    '.....####.......',
    '....#@@@@#......',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '....#@@@@#......',
    '....######......',
    '...#@@@@@@#.....',
    '..#@@@@@@@#.....',
    '..#@#@@@@#@#....',
    '...#@@@@@@#.....',
    '...#@@##@@#.....',
    '...#@@##@@#.....',
    '....##..##......',
    '................',
  ],
  'up_1': [
    '.....####.......',
    '....#@@@@#......',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '....#@@@@#......',
    '....######......',
    '...#@@@@@@#.....',
    '..#@@@@@@@#.....',
    '..#@#@@@@#@#....',
    '...#@@@@@@#.....',
    '...#@@##@@#.....',
    '..#@@#..#@@#....',
    '..##......##....',
    '................',
  ],
  'up_2': [
    '.....####.......',
    '....#@@@@#......',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '....#@@@@#......',
    '....######......',
    '...#@@@@@@#.....',
    '..#@@@@@@@#.....',
    '..#@#@@@@#@#....',
    '...#@@@@@@#.....',
    '...#@@##@@#.....',
    '....#@@##@@#....',
    '....##....##....',
    '................',
  ],
  'left_0': [
    '....####........',
    '...#@@@@#.......',
    '..#@@@@@#.......',
    '..#@@@@@#.......',
    '..#Oo@@@#.......',
    '..#oooo#........',
    '...#ooo#........',
    '...######.......',
    '..#@@@@@@#......',
    '.#@@@@@@@#......',
    '.#@#@@@@@@#.....',
    '..#@@@@@@#......',
    '..#@@##@@#......',
    '..#@@##@@#......',
    '...##..##.......',
    '................',
  ],
  'left_1': [
    '....####........',
    '...#@@@@#.......',
    '..#@@@@@#.......',
    '..#@@@@@#.......',
    '..#Oo@@@#.......',
    '..#oooo#........',
    '...#ooo#........',
    '...######.......',
    '..#@@@@@@#......',
    '.#@@@@@@@#......',
    '.#@#@@@@@@#.....',
    '..#@@@@@@#......',
    '..#@@##@@#......',
    '.#@@#..#@@#.....',
    '.##......##.....',
    '................',
  ],
  'left_2': [
    '....####........',
    '...#@@@@#.......',
    '..#@@@@@#.......',
    '..#@@@@@#.......',
    '..#Oo@@@#.......',
    '..#oooo#........',
    '...#ooo#........',
    '...######.......',
    '..#@@@@@@#......',
    '.#@@@@@@@#......',
    '.#@#@@@@@@#.....',
    '..#@@@@@@#......',
    '..#@@##@@#......',
    '...#@@##@@#.....',
    '...##....##.....',
    '................',
  ],
  'right_0': [
    '........####....',
    '.......#@@@@#...',
    '.......#@@@@@#..',
    '.......#@@@@@#..',
    '.......#@@@oO#..',
    '........#oooo#..',
    '........#ooo#...',
    '.......######...',
    '......#@@@@@@#..',
    '......#@@@@@@@#.',
    '.....#@@@@@@#@#.',
    '......#@@@@@@#..',
    '......#@@##@@#..',
    '......#@@##@@#..',
    '.......##..##...',
    '................',
  ],
  'right_1': [
    '........####....',
    '.......#@@@@#...',
    '.......#@@@@@#..',
    '.......#@@@@@#..',
    '.......#@@@oO#..',
    '........#oooo#..',
    '........#ooo#...',
    '.......######...',
    '......#@@@@@@#..',
    '......#@@@@@@@#.',
    '.....#@@@@@@#@#.',
    '......#@@@@@@#..',
    '......#@@##@@#..',
    '.....#@@#..#@@#.',
    '.....##......##.',
    '................',
  ],
  'right_2': [
    '........####....',
    '.......#@@@@#...',
    '.......#@@@@@#..',
    '.......#@@@@@#..',
    '.......#@@@oO#..',
    '........#oooo#..',
    '........#ooo#...',
    '.......######...',
    '......#@@@@@@#..',
    '......#@@@@@@@#.',
    '.....#@@@@@@#@#.',
    '......#@@@@@@#..',
    '......#@@##@@#..',
    '.......#@@##@@#.',
    '.......##..##...',
    '................',
  ],
};

// SCIENTIST - lab coat with glasses
const SCIENTIST_SPRITES: Record<string, string[]> = {
  'down_0': [
    '.....####.......',
    '....#@@@@#......',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '...#OO##OO#.....',  // Glasses
    '...#oooooo#.....',
    '....#oooo#......',
    '...##OOOO##.....',  // Lab coat collar
    '..#OOOOOOOO#....',  // White coat
    '.#OOOOOOOOOO#...',
    '.#O#OOOOOO#O#...',
    '..#OOOOOOOO#....',
    '..#OO####OO#....',
    '...#@@##@@#.....',
    '....##..##......',
    '................',
  ],
  'down_1': [
    '.....####.......',
    '....#@@@@#......',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '...#OO##OO#.....',
    '...#oooooo#.....',
    '....#oooo#......',
    '...##OOOO##.....',
    '..#OOOOOOOO#....',
    '.#OOOOOOOOOO#...',
    '.#O#OOOOOO#O#...',
    '..#OOOOOOOO#....',
    '..#OO####OO#....',
    '..#@@#..#@@#....',
    '..##......##....',
    '................',
  ],
  'down_2': [
    '.....####.......',
    '....#@@@@#......',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '...#OO##OO#.....',
    '...#oooooo#.....',
    '....#oooo#......',
    '...##OOOO##.....',
    '..#OOOOOOOO#....',
    '.#OOOOOOOOOO#...',
    '.#O#OOOOOO#O#...',
    '..#OOOOOOOO#....',
    '..#OO####OO#....',
    '...#@@##@@#.....',
    '....##..##......',
    '................',
  ],
  'up_0': [
    '.....####.......',
    '....#@@@@#......',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '....#@@@@#......',
    '...##OOOO##.....',
    '..#OOOOOOOO#....',
    '.#OOOOOOOOOO#...',
    '.#O#OOOOOO#O#...',
    '..#OOOOOOOO#....',
    '..#OO####OO#....',
    '...#@@##@@#.....',
    '....##..##......',
    '................',
  ],
  'up_1': [
    '.....####.......',
    '....#@@@@#......',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '....#@@@@#......',
    '...##OOOO##.....',
    '..#OOOOOOOO#....',
    '.#OOOOOOOOOO#...',
    '.#O#OOOOOO#O#...',
    '..#OOOOOOOO#....',
    '..#OO####OO#....',
    '..#@@#..#@@#....',
    '..##......##....',
    '................',
  ],
  'up_2': [
    '.....####.......',
    '....#@@@@#......',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '....#@@@@#......',
    '...##OOOO##.....',
    '..#OOOOOOOO#....',
    '.#OOOOOOOOOO#...',
    '.#O#OOOOOO#O#...',
    '..#OOOOOOOO#....',
    '..#OO####OO#....',
    '...#@@##@@#.....',
    '....##..##......',
    '................',
  ],
  'left_0': [
    '....####........',
    '...#@@@@#.......',
    '..#@@@@@#.......',
    '..#@@@@@#.......',
    '..#OO@@@#.......',
    '..#oooo#........',
    '...#ooo#........',
    '..##OOOO##......',
    '.#OOOOOOOO#.....',
    '#OOOOOOOOOO#....',
    '#O#OOOOOOOO#....',
    '.#OOOOOOOO#.....',
    '.#OO####OO#.....',
    '..#@@##@@#......',
    '...##..##.......',
    '................',
  ],
  'left_1': [
    '....####........',
    '...#@@@@#.......',
    '..#@@@@@#.......',
    '..#@@@@@#.......',
    '..#OO@@@#.......',
    '..#oooo#........',
    '...#ooo#........',
    '..##OOOO##......',
    '.#OOOOOOOO#.....',
    '#OOOOOOOOOO#....',
    '#O#OOOOOOOO#....',
    '.#OOOOOOOO#.....',
    '.#OO####OO#.....',
    '#@@#....#@@#....',
    '##........##....',
    '................',
  ],
  'left_2': [
    '....####........',
    '...#@@@@#.......',
    '..#@@@@@#.......',
    '..#@@@@@#.......',
    '..#OO@@@#.......',
    '..#oooo#........',
    '...#ooo#........',
    '..##OOOO##......',
    '.#OOOOOOOO#.....',
    '#OOOOOOOOOO#....',
    '#O#OOOOOOOO#....',
    '.#OOOOOOOO#.....',
    '.#OO####OO#.....',
    '..#@@##@@#......',
    '...##..##.......',
    '................',
  ],
  'right_0': [
    '........####....',
    '.......#@@@@#...',
    '.......#@@@@@#..',
    '.......#@@@@@#..',
    '.......#@@@OO#..',
    '........#oooo#..',
    '........#ooo#...',
    '......##OOOO##..',
    '.....#OOOOOOOO#.',
    '....#OOOOOOOOOO#',
    '....#OOOOOOOO#O#',
    '.....#OOOOOOOO#.',
    '.....#OO####OO#.',
    '......#@@##@@#..',
    '.......##..##...',
    '................',
  ],
  'right_1': [
    '........####....',
    '.......#@@@@#...',
    '.......#@@@@@#..',
    '.......#@@@@@#..',
    '.......#@@@OO#..',
    '........#oooo#..',
    '........#ooo#...',
    '......##OOOO##..',
    '.....#OOOOOOOO#.',
    '....#OOOOOOOOOO#',
    '....#OOOOOOOO#O#',
    '.....#OOOOOOOO#.',
    '.....#OO####OO#.',
    '....#@@#....#@@#',
    '....##........##',
    '................',
  ],
  'right_2': [
    '........####....',
    '.......#@@@@#...',
    '.......#@@@@@#..',
    '.......#@@@@@#..',
    '.......#@@@OO#..',
    '........#oooo#..',
    '........#ooo#...',
    '......##OOOO##..',
    '.....#OOOOOOOO#.',
    '....#OOOOOOOOOO#',
    '....#OOOOOOOO#O#',
    '.....#OOOOOOOO#.',
    '.....#OO####OO#.',
    '......#@@##@@#..',
    '.......##..##...',
    '................',
  ],
};

// VILLAIN (Team Finn) - dark clothes with sinister look
const VILLAIN_SPRITES: Record<string, string[]> = {
  'down_0': [
    '.....####.......',
    '....#@@@@#......',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '...#oO##Oo#.....',
    '...##oooo##.....',  // Stern expression
    '....#oooo#......',
    '....#@@@@#......',
    '...#@@@@@@#.....',
    '..#@@#@@#@@#....',  // Fin logo on chest
    '..#@#@@@@#@#....',
    '...#@@@@@@#.....',
    '...#@@##@@#.....',
    '...#@@##@@#.....',
    '....##..##......',
    '................',
  ],
  'down_1': [
    '.....####.......',
    '....#@@@@#......',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '...#oO##Oo#.....',
    '...##oooo##.....',
    '....#oooo#......',
    '....#@@@@#......',
    '...#@@@@@@#.....',
    '..#@@#@@#@@#....',
    '..#@#@@@@#@#....',
    '...#@@@@@@#.....',
    '...#@@##@@#.....',
    '..#@@#..#@@#....',
    '..##......##....',
    '................',
  ],
  'down_2': [
    '.....####.......',
    '....#@@@@#......',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '...#oO##Oo#.....',
    '...##oooo##.....',
    '....#oooo#......',
    '....#@@@@#......',
    '...#@@@@@@#.....',
    '..#@@#@@#@@#....',
    '..#@#@@@@#@#....',
    '...#@@@@@@#.....',
    '...#@@##@@#.....',
    '....#@@##@@#....',
    '....##....##....',
    '................',
  ],
  'up_0': [
    '.....####.......',
    '....#@@@@#......',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '....#@@@@#......',
    '....#@@@@#......',
    '...#@@@@@@#.....',
    '..#@@#@@#@@#....',
    '..#@#@@@@#@#....',
    '...#@@@@@@#.....',
    '...#@@##@@#.....',
    '...#@@##@@#.....',
    '....##..##......',
    '................',
  ],
  'up_1': [
    '.....####.......',
    '....#@@@@#......',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '....#@@@@#......',
    '....#@@@@#......',
    '...#@@@@@@#.....',
    '..#@@#@@#@@#....',
    '..#@#@@@@#@#....',
    '...#@@@@@@#.....',
    '...#@@##@@#.....',
    '..#@@#..#@@#....',
    '..##......##....',
    '................',
  ],
  'up_2': [
    '.....####.......',
    '....#@@@@#......',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '....#@@@@#......',
    '....#@@@@#......',
    '...#@@@@@@#.....',
    '..#@@#@@#@@#....',
    '..#@#@@@@#@#....',
    '...#@@@@@@#.....',
    '...#@@##@@#.....',
    '....#@@##@@#....',
    '....##....##....',
    '................',
  ],
  'left_0': [
    '....####........',
    '...#@@@@#.......',
    '..#@@@@@#.......',
    '..#@@@@@#.......',
    '..#Oo@@@#.......',
    '..##ooo#........',
    '...#ooo#........',
    '...#@@@@#.......',
    '..#@@@@@@#......',
    '.#@@#@@#@@#.....',
    '.#@#@@@@@@#.....',
    '..#@@@@@@#......',
    '..#@@##@@#......',
    '..#@@##@@#......',
    '...##..##.......',
    '................',
  ],
  'left_1': [
    '....####........',
    '...#@@@@#.......',
    '..#@@@@@#.......',
    '..#@@@@@#.......',
    '..#Oo@@@#.......',
    '..##ooo#........',
    '...#ooo#........',
    '...#@@@@#.......',
    '..#@@@@@@#......',
    '.#@@#@@#@@#.....',
    '.#@#@@@@@@#.....',
    '..#@@@@@@#......',
    '..#@@##@@#......',
    '.#@@#..#@@#.....',
    '.##......##.....',
    '................',
  ],
  'left_2': [
    '....####........',
    '...#@@@@#.......',
    '..#@@@@@#.......',
    '..#@@@@@#.......',
    '..#Oo@@@#.......',
    '..##ooo#........',
    '...#ooo#........',
    '...#@@@@#.......',
    '..#@@@@@@#......',
    '.#@@#@@#@@#.....',
    '.#@#@@@@@@#.....',
    '..#@@@@@@#......',
    '..#@@##@@#......',
    '...#@@##@@#.....',
    '...##....##.....',
    '................',
  ],
  'right_0': [
    '........####....',
    '.......#@@@@#...',
    '.......#@@@@@#..',
    '.......#@@@@@#..',
    '.......#@@@oO#..',
    '........#ooo##..',
    '........#ooo#...',
    '.......#@@@@#...',
    '......#@@@@@@#..',
    '.....#@@#@@#@@#.',
    '.....#@@@@@@#@#.',
    '......#@@@@@@#..',
    '......#@@##@@#..',
    '......#@@##@@#..',
    '.......##..##...',
    '................',
  ],
  'right_1': [
    '........####....',
    '.......#@@@@#...',
    '.......#@@@@@#..',
    '.......#@@@@@#..',
    '.......#@@@oO#..',
    '........#ooo##..',
    '........#ooo#...',
    '.......#@@@@#...',
    '......#@@@@@@#..',
    '.....#@@#@@#@@#.',
    '.....#@@@@@@#@#.',
    '......#@@@@@@#..',
    '......#@@##@@#..',
    '.....#@@#..#@@#.',
    '.....##......##.',
    '................',
  ],
  'right_2': [
    '........####....',
    '.......#@@@@#...',
    '.......#@@@@@#..',
    '.......#@@@@@#..',
    '.......#@@@oO#..',
    '........#ooo##..',
    '........#ooo#...',
    '.......#@@@@#...',
    '......#@@@@@@#..',
    '.....#@@#@@#@@#.',
    '.....#@@@@@@#@#.',
    '......#@@@@@@#..',
    '......#@@##@@#..',
    '.......#@@##@@#.',
    '.......##..##...',
    '................',
  ],
};

// FISHER - hat, casual clothes
const FISHER_SPRITES: Record<string, string[]> = {
  'down_0': [
    '...########.....',
    '..#OOOOOOOO#....',  // Hat brim
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '...#oO##Oo#.....',
    '...#oooooo#.....',
    '....#oooo#......',
    '....##oo##......',
    '...#oooooo#.....',  // T-shirt (light colored)
    '..#oooooooo#....',
    '..#o#oooo#o#....',
    '...#oooooo#.....',
    '...#@@##@@#.....',  // Pants
    '...#@@##@@#.....',
    '....##..##......',
    '................',
  ],
  'down_1': [
    '...########.....',
    '..#OOOOOOOO#....',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '...#oO##Oo#.....',
    '...#oooooo#.....',
    '....#oooo#......',
    '....##oo##......',
    '...#oooooo#.....',
    '..#oooooooo#....',
    '..#o#oooo#o#....',
    '...#oooooo#.....',
    '...#@@##@@#.....',
    '..#@@#..#@@#....',
    '..##......##....',
    '................',
  ],
  'down_2': [
    '...########.....',
    '..#OOOOOOOO#....',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '...#oO##Oo#.....',
    '...#oooooo#.....',
    '....#oooo#......',
    '....##oo##......',
    '...#oooooo#.....',
    '..#oooooooo#....',
    '..#o#oooo#o#....',
    '...#oooooo#.....',
    '...#@@##@@#.....',
    '....#@@##@@#....',
    '....##....##....',
    '................',
  ],
  'up_0': [
    '...########.....',
    '..#@@@@@@@@#....',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '....#@@@@#......',
    '....##oo##......',
    '...#oooooo#.....',
    '..#oooooooo#....',
    '..#o#oooo#o#....',
    '...#oooooo#.....',
    '...#@@##@@#.....',
    '...#@@##@@#.....',
    '....##..##......',
    '................',
  ],
  'up_1': [
    '...########.....',
    '..#@@@@@@@@#....',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '....#@@@@#......',
    '....##oo##......',
    '...#oooooo#.....',
    '..#oooooooo#....',
    '..#o#oooo#o#....',
    '...#oooooo#.....',
    '...#@@##@@#.....',
    '..#@@#..#@@#....',
    '..##......##....',
    '................',
  ],
  'up_2': [
    '...########.....',
    '..#@@@@@@@@#....',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '....#@@@@#......',
    '....##oo##......',
    '...#oooooo#.....',
    '..#oooooooo#....',
    '..#o#oooo#o#....',
    '...#oooooo#.....',
    '...#@@##@@#.....',
    '....#@@##@@#....',
    '....##....##....',
    '................',
  ],
  'left_0': [
    '..########......',
    '.#OOOOOOOO#.....',
    '..#@@@@@#.......',
    '..#@@@@@#.......',
    '..#Oo@@@#.......',
    '..#oooo#........',
    '...#ooo#........',
    '...##oo##.......',
    '..#oooooo#......',
    '.#oooooooo#.....',
    '.#o#oooooo#.....',
    '..#oooooo#......',
    '..#@@##@@#......',
    '..#@@##@@#......',
    '...##..##.......',
    '................',
  ],
  'left_1': [
    '..########......',
    '.#OOOOOOOO#.....',
    '..#@@@@@#.......',
    '..#@@@@@#.......',
    '..#Oo@@@#.......',
    '..#oooo#........',
    '...#ooo#........',
    '...##oo##.......',
    '..#oooooo#......',
    '.#oooooooo#.....',
    '.#o#oooooo#.....',
    '..#oooooo#......',
    '..#@@##@@#......',
    '.#@@#..#@@#.....',
    '.##......##.....',
    '................',
  ],
  'left_2': [
    '..########......',
    '.#OOOOOOOO#.....',
    '..#@@@@@#.......',
    '..#@@@@@#.......',
    '..#Oo@@@#.......',
    '..#oooo#........',
    '...#ooo#........',
    '...##oo##.......',
    '..#oooooo#......',
    '.#oooooooo#.....',
    '.#o#oooooo#.....',
    '..#oooooo#......',
    '..#@@##@@#......',
    '...#@@##@@#.....',
    '...##....##.....',
    '................',
  ],
  'right_0': [
    '......########..',
    '.....#OOOOOOOO#.',
    '.......#@@@@@#..',
    '.......#@@@@@#..',
    '.......#@@@oO#..',
    '........#oooo#..',
    '........#ooo#...',
    '.......##oo##...',
    '......#oooooo#..',
    '.....#oooooooo#.',
    '.....#oooooo#o#.',
    '......#oooooo#..',
    '......#@@##@@#..',
    '......#@@##@@#..',
    '.......##..##...',
    '................',
  ],
  'right_1': [
    '......########..',
    '.....#OOOOOOOO#.',
    '.......#@@@@@#..',
    '.......#@@@@@#..',
    '.......#@@@oO#..',
    '........#oooo#..',
    '........#ooo#...',
    '.......##oo##...',
    '......#oooooo#..',
    '.....#oooooooo#.',
    '.....#oooooo#o#.',
    '......#oooooo#..',
    '......#@@##@@#..',
    '.....#@@#..#@@#.',
    '.....##......##.',
    '................',
  ],
  'right_2': [
    '......########..',
    '.....#OOOOOOOO#.',
    '.......#@@@@@#..',
    '.......#@@@@@#..',
    '.......#@@@oO#..',
    '........#oooo#..',
    '........#ooo#...',
    '.......##oo##...',
    '......#oooooo#..',
    '.....#oooooooo#.',
    '.....#oooooo#o#.',
    '......#oooooo#..',
    '......#@@##@@#..',
    '.......#@@##@@#.',
    '.......##..##...',
    '................',
  ],
};

// SHOPKEEPER - with apron
const SHOPKEEPER_SPRITES: Record<string, string[]> = {
  'down_0': [
    '.....####.......',
    '....#@@@@#......',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '...#oO##Oo#.....',
    '...#oooooo#.....',
    '....#oooo#......',
    '....##@@##......',
    '...#OOOOOO#.....',  // Apron
    '..#OOOOOOOO#....',
    '..#O#OOOO#O#....',
    '...#OOOOOO#.....',
    '...#OO##OO#.....',
    '...#@@##@@#.....',
    '....##..##......',
    '................',
  ],
  'down_1': [
    '.....####.......',
    '....#@@@@#......',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '...#oO##Oo#.....',
    '...#oooooo#.....',
    '....#oooo#......',
    '....##@@##......',
    '...#OOOOOO#.....',
    '..#OOOOOOOO#....',
    '..#O#OOOO#O#....',
    '...#OOOOOO#.....',
    '...#OO##OO#.....',
    '..#@@#..#@@#....',
    '..##......##....',
    '................',
  ],
  'down_2': [
    '.....####.......',
    '....#@@@@#......',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '...#oO##Oo#.....',
    '...#oooooo#.....',
    '....#oooo#......',
    '....##@@##......',
    '...#OOOOOO#.....',
    '..#OOOOOOOO#....',
    '..#O#OOOO#O#....',
    '...#OOOOOO#.....',
    '...#OO##OO#.....',
    '....#@@##@@#....',
    '....##....##....',
    '................',
  ],
  'up_0': [
    '.....####.......',
    '....#@@@@#......',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '....#@@@@#......',
    '....##@@##......',
    '...#@@@@@@#.....',
    '..#@@@@@@@@#....',
    '..#@#@@@@#@#....',
    '...#@@@@@@#.....',
    '...#@@##@@#.....',
    '...#@@##@@#.....',
    '....##..##......',
    '................',
  ],
  'up_1': [
    '.....####.......',
    '....#@@@@#......',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '....#@@@@#......',
    '....##@@##......',
    '...#@@@@@@#.....',
    '..#@@@@@@@@#....',
    '..#@#@@@@#@#....',
    '...#@@@@@@#.....',
    '...#@@##@@#.....',
    '..#@@#..#@@#....',
    '..##......##....',
    '................',
  ],
  'up_2': [
    '.....####.......',
    '....#@@@@#......',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '....#@@@@#......',
    '....##@@##......',
    '...#@@@@@@#.....',
    '..#@@@@@@@@#....',
    '..#@#@@@@#@#....',
    '...#@@@@@@#.....',
    '...#@@##@@#.....',
    '....#@@##@@#....',
    '....##....##....',
    '................',
  ],
  'left_0': [
    '....####........',
    '...#@@@@#.......',
    '..#@@@@@#.......',
    '..#@@@@@#.......',
    '..#Oo@@@#.......',
    '..#oooo#........',
    '...#ooo#........',
    '...##@@##.......',
    '..#OOOOOO#......',
    '.#OOOOOOOO#.....',
    '.#O#OOOOOO#.....',
    '..#OOOOOO#......',
    '..#OO##OO#......',
    '..#@@##@@#......',
    '...##..##.......',
    '................',
  ],
  'left_1': [
    '....####........',
    '...#@@@@#.......',
    '..#@@@@@#.......',
    '..#@@@@@#.......',
    '..#Oo@@@#.......',
    '..#oooo#........',
    '...#ooo#........',
    '...##@@##.......',
    '..#OOOOOO#......',
    '.#OOOOOOOO#.....',
    '.#O#OOOOOO#.....',
    '..#OOOOOO#......',
    '..#OO##OO#......',
    '.#@@#..#@@#.....',
    '.##......##.....',
    '................',
  ],
  'left_2': [
    '....####........',
    '...#@@@@#.......',
    '..#@@@@@#.......',
    '..#@@@@@#.......',
    '..#Oo@@@#.......',
    '..#oooo#........',
    '...#ooo#........',
    '...##@@##.......',
    '..#OOOOOO#......',
    '.#OOOOOOOO#.....',
    '.#O#OOOOOO#.....',
    '..#OOOOOO#......',
    '..#OO##OO#......',
    '...#@@##@@#.....',
    '...##....##.....',
    '................',
  ],
  'right_0': [
    '........####....',
    '.......#@@@@#...',
    '.......#@@@@@#..',
    '.......#@@@@@#..',
    '.......#@@@oO#..',
    '........#oooo#..',
    '........#ooo#...',
    '.......##@@##...',
    '......#OOOOOO#..',
    '.....#OOOOOOOO#.',
    '.....#OOOOOO#O#.',
    '......#OOOOOO#..',
    '......#OO##OO#..',
    '......#@@##@@#..',
    '.......##..##...',
    '................',
  ],
  'right_1': [
    '........####....',
    '.......#@@@@#...',
    '.......#@@@@@#..',
    '.......#@@@@@#..',
    '.......#@@@oO#..',
    '........#oooo#..',
    '........#ooo#...',
    '.......##@@##...',
    '......#OOOOOO#..',
    '.....#OOOOOOOO#.',
    '.....#OOOOOO#O#.',
    '......#OOOOOO#..',
    '......#OO##OO#..',
    '.....#@@#..#@@#.',
    '.....##......##.',
    '................',
  ],
  'right_2': [
    '........####....',
    '.......#@@@@#...',
    '.......#@@@@@#..',
    '.......#@@@@@#..',
    '.......#@@@oO#..',
    '........#oooo#..',
    '........#ooo#...',
    '.......##@@##...',
    '......#OOOOOO#..',
    '.....#OOOOOOOO#.',
    '.....#OOOOOO#O#.',
    '......#OOOOOO#..',
    '......#OO##OO#..',
    '.......#@@##@@#.',
    '.......##..##...',
    '................',
  ],
};

// GYM LEADER - distinctive outfit
const GYMLEADER_SPRITES: Record<string, string[]> = {
  'down_0': [
    '....######......',
    '...#@@@@@@#.....',  // Spiky hair
    '..#@@#@@#@@#....',
    '...#@@@@@@#.....',
    '...#oO##Oo#.....',
    '...#oooooo#.....',
    '....#oooo#......',
    '...##@@@@##.....',
    '..#@@OOOO@@#....',  // Belt/badge
    '.#@@@@@@@@@@#...',
    '.#@#@@@@@@#@#...',
    '..#@@@@@@@@#....',
    '..#@@####@@#....',
    '...#@@##@@#.....',
    '....##..##......',
    '................',
  ],
  'down_1': [
    '....######......',
    '...#@@@@@@#.....',
    '..#@@#@@#@@#....',
    '...#@@@@@@#.....',
    '...#oO##Oo#.....',
    '...#oooooo#.....',
    '....#oooo#......',
    '...##@@@@##.....',
    '..#@@OOOO@@#....',
    '.#@@@@@@@@@@#...',
    '.#@#@@@@@@#@#...',
    '..#@@@@@@@@#....',
    '..#@@####@@#....',
    '..#@@#..#@@#....',
    '..##......##....',
    '................',
  ],
  'down_2': [
    '....######......',
    '...#@@@@@@#.....',
    '..#@@#@@#@@#....',
    '...#@@@@@@#.....',
    '...#oO##Oo#.....',
    '...#oooooo#.....',
    '....#oooo#......',
    '...##@@@@##.....',
    '..#@@OOOO@@#....',
    '.#@@@@@@@@@@#...',
    '.#@#@@@@@@#@#...',
    '..#@@@@@@@@#....',
    '..#@@####@@#....',
    '...#@@##@@#.....',
    '....##..##......',
    '................',
  ],
  'up_0': [
    '....######......',
    '...#@@@@@@#.....',
    '..#@@#@@#@@#....',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '....#@@@@#......',
    '...##@@@@##.....',
    '..#@@@@@@@@#....',
    '.#@@@@@@@@@@#...',
    '.#@#@@@@@@#@#...',
    '..#@@@@@@@@#....',
    '..#@@####@@#....',
    '...#@@##@@#.....',
    '....##..##......',
    '................',
  ],
  'up_1': [
    '....######......',
    '...#@@@@@@#.....',
    '..#@@#@@#@@#....',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '....#@@@@#......',
    '...##@@@@##.....',
    '..#@@@@@@@@#....',
    '.#@@@@@@@@@@#...',
    '.#@#@@@@@@#@#...',
    '..#@@@@@@@@#....',
    '..#@@####@@#....',
    '..#@@#..#@@#....',
    '..##......##....',
    '................',
  ],
  'up_2': [
    '....######......',
    '...#@@@@@@#.....',
    '..#@@#@@#@@#....',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '....#@@@@#......',
    '...##@@@@##.....',
    '..#@@@@@@@@#....',
    '.#@@@@@@@@@@#...',
    '.#@#@@@@@@#@#...',
    '..#@@@@@@@@#....',
    '..#@@####@@#....',
    '...#@@##@@#.....',
    '....##..##......',
    '................',
  ],
  'left_0': [
    '...######.......',
    '..#@@@@@@#......',
    '.#@@#@@#@@#.....',
    '..#@@@@@#.......',
    '..#Oo@@@#.......',
    '..#oooo#........',
    '...#ooo#........',
    '..##@@@@##......',
    '.#@@OOOO@@#.....',
    '#@@@@@@@@@@#....',
    '#@#@@@@@@@@#....',
    '.#@@@@@@@@#.....',
    '.#@@####@@#.....',
    '..#@@##@@#......',
    '...##..##.......',
    '................',
  ],
  'left_1': [
    '...######.......',
    '..#@@@@@@#......',
    '.#@@#@@#@@#.....',
    '..#@@@@@#.......',
    '..#Oo@@@#.......',
    '..#oooo#........',
    '...#ooo#........',
    '..##@@@@##......',
    '.#@@OOOO@@#.....',
    '#@@@@@@@@@@#....',
    '#@#@@@@@@@@#....',
    '.#@@@@@@@@#.....',
    '.#@@####@@#.....',
    '#@@#....#@@#....',
    '##........##....',
    '................',
  ],
  'left_2': [
    '...######.......',
    '..#@@@@@@#......',
    '.#@@#@@#@@#.....',
    '..#@@@@@#.......',
    '..#Oo@@@#.......',
    '..#oooo#........',
    '...#ooo#........',
    '..##@@@@##......',
    '.#@@OOOO@@#.....',
    '#@@@@@@@@@@#....',
    '#@#@@@@@@@@#....',
    '.#@@@@@@@@#.....',
    '.#@@####@@#.....',
    '..#@@##@@#......',
    '...##..##.......',
    '................',
  ],
  'right_0': [
    '.......######...',
    '......#@@@@@@#..',
    '.....#@@#@@#@@#.',
    '.......#@@@@@#..',
    '.......#@@@oO#..',
    '........#oooo#..',
    '........#ooo#...',
    '......##@@@@##..',
    '.....#@@OOOO@@#.',
    '....#@@@@@@@@@@#',
    '....#@@@@@@@@#@#',
    '.....#@@@@@@@@#.',
    '.....#@@####@@#.',
    '......#@@##@@#..',
    '.......##..##...',
    '................',
  ],
  'right_1': [
    '.......######...',
    '......#@@@@@@#..',
    '.....#@@#@@#@@#.',
    '.......#@@@@@#..',
    '.......#@@@oO#..',
    '........#oooo#..',
    '........#ooo#...',
    '......##@@@@##..',
    '.....#@@OOOO@@#.',
    '....#@@@@@@@@@@#',
    '....#@@@@@@@@#@#',
    '.....#@@@@@@@@#.',
    '.....#@@####@@#.',
    '....#@@#....#@@#',
    '....##........##',
    '................',
  ],
  'right_2': [
    '.......######...',
    '......#@@@@@@#..',
    '.....#@@#@@#@@#.',
    '.......#@@@@@#..',
    '.......#@@@oO#..',
    '........#oooo#..',
    '........#ooo#...',
    '......##@@@@##..',
    '.....#@@OOOO@@#.',
    '....#@@@@@@@@@@#',
    '....#@@@@@@@@#@#',
    '.....#@@@@@@@@#.',
    '.....#@@####@@#.',
    '......#@@##@@#..',
    '.......##..##...',
    '................',
  ],
};

// DIVER - SCUBA gear
const DIVER_SPRITES: Record<string, string[]> = {
  'down_0': [
    '.....####.......',
    '....#@@@@#......',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '...#OO##OO#.....',  // Mask
    '...#oooooo#.....',
    '....#oooo#......',
    '....#OOOO#......',  // Tank straps
    '...#@@OO@@#.....',  // Tank visible
    '..#@@@@@@@@#....',
    '..#@#@@@@#@#....',
    '...#@@@@@@#.....',
    '...#@@##@@#.....',
    '...#@@##@@#.....',  // Fins
    '...###..###.....',
    '................',
  ],
  'down_1': [
    '.....####.......',
    '....#@@@@#......',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '...#OO##OO#.....',
    '...#oooooo#.....',
    '....#oooo#......',
    '....#OOOO#......',
    '...#@@OO@@#.....',
    '..#@@@@@@@@#....',
    '..#@#@@@@#@#....',
    '...#@@@@@@#.....',
    '...#@@##@@#.....',
    '..#@@#..#@@#....',
    '.###......###...',
    '................',
  ],
  'down_2': [
    '.....####.......',
    '....#@@@@#......',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '...#OO##OO#.....',
    '...#oooooo#.....',
    '....#oooo#......',
    '....#OOOO#......',
    '...#@@OO@@#.....',
    '..#@@@@@@@@#....',
    '..#@#@@@@#@#....',
    '...#@@@@@@#.....',
    '...#@@##@@#.....',
    '....#@@##@@#....',
    '....###..###....',
    '................',
  ],
  'up_0': [
    '.....####.......',
    '....#@@@@#......',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '....#@@@@#......',
    '....#OOOO#......',
    '...#@@OO@@#.....',
    '..#@@@@@@@@#....',
    '..#@#@@@@#@#....',
    '...#@@@@@@#.....',
    '...#@@##@@#.....',
    '...#@@##@@#.....',
    '...###..###.....',
    '................',
  ],
  'up_1': [
    '.....####.......',
    '....#@@@@#......',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '....#@@@@#......',
    '....#OOOO#......',
    '...#@@OO@@#.....',
    '..#@@@@@@@@#....',
    '..#@#@@@@#@#....',
    '...#@@@@@@#.....',
    '...#@@##@@#.....',
    '..#@@#..#@@#....',
    '.###......###...',
    '................',
  ],
  'up_2': [
    '.....####.......',
    '....#@@@@#......',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '....#@@@@#......',
    '....#OOOO#......',
    '...#@@OO@@#.....',
    '..#@@@@@@@@#....',
    '..#@#@@@@#@#....',
    '...#@@@@@@#.....',
    '...#@@##@@#.....',
    '....#@@##@@#....',
    '....###..###....',
    '................',
  ],
  'left_0': [
    '....####........',
    '...#@@@@#.......',
    '..#@@@@@#.......',
    '..#@@@@@#.......',
    '..#OO@@@#.......',
    '..#oooo#........',
    '...#ooo#........',
    '...#OOOO#.......',
    '..#@@OO@@#......',
    '.#@@@@@@@@#.....',
    '.#@#@@@@@@#.....',
    '..#@@@@@@#......',
    '..#@@##@@#......',
    '..#@@##@@#......',
    '..###..###......',
    '................',
  ],
  'left_1': [
    '....####........',
    '...#@@@@#.......',
    '..#@@@@@#.......',
    '..#@@@@@#.......',
    '..#OO@@@#.......',
    '..#oooo#........',
    '...#ooo#........',
    '...#OOOO#.......',
    '..#@@OO@@#......',
    '.#@@@@@@@@#.....',
    '.#@#@@@@@@#.....',
    '..#@@@@@@#......',
    '..#@@##@@#......',
    '.#@@#..#@@#.....',
    '###......###....',
    '................',
  ],
  'left_2': [
    '....####........',
    '...#@@@@#.......',
    '..#@@@@@#.......',
    '..#@@@@@#.......',
    '..#OO@@@#.......',
    '..#oooo#........',
    '...#ooo#........',
    '...#OOOO#.......',
    '..#@@OO@@#......',
    '.#@@@@@@@@#.....',
    '.#@#@@@@@@#.....',
    '..#@@@@@@#......',
    '..#@@##@@#......',
    '...#@@##@@#.....',
    '...###..###.....',
    '................',
  ],
  'right_0': [
    '........####....',
    '.......#@@@@#...',
    '.......#@@@@@#..',
    '.......#@@@@@#..',
    '.......#@@@OO#..',
    '........#oooo#..',
    '........#ooo#...',
    '.......#OOOO#...',
    '......#@@OO@@#..',
    '.....#@@@@@@@@#.',
    '.....#@@@@@@#@#.',
    '......#@@@@@@#..',
    '......#@@##@@#..',
    '......#@@##@@#..',
    '......###..###..',
    '................',
  ],
  'right_1': [
    '........####....',
    '.......#@@@@#...',
    '.......#@@@@@#..',
    '.......#@@@@@#..',
    '.......#@@@OO#..',
    '........#oooo#..',
    '........#ooo#...',
    '.......#OOOO#...',
    '......#@@OO@@#..',
    '.....#@@@@@@@@#.',
    '.....#@@@@@@#@#.',
    '......#@@@@@@#..',
    '......#@@##@@#..',
    '.....#@@#..#@@#.',
    '....###......###',
    '................',
  ],
  'right_2': [
    '........####....',
    '.......#@@@@#...',
    '.......#@@@@@#..',
    '.......#@@@@@#..',
    '.......#@@@OO#..',
    '........#oooo#..',
    '........#ooo#...',
    '.......#OOOO#...',
    '......#@@OO@@#..',
    '.....#@@@@@@@@#.',
    '.....#@@@@@@#@#.',
    '......#@@@@@@#..',
    '......#@@##@@#..',
    '.......#@@##@@#.',
    '.......###..###.',
    '................',
  ],
};

// KID - smaller NPC
const KID_SPRITES: Record<string, string[]> = {
  'down_0': [
    '................',
    '................',
    '.....####.......',
    '....#@@@@#......',
    '...#@@@@@@#.....',
    '...#oO##Oo#.....',
    '...#oooooo#.....',
    '....#oooo#......',
    '....##@@##......',
    '...#oooooo#.....',
    '...#o#oo#o#.....',
    '....#oooo#......',
    '....#@@@@#......',
    '....#@@@@#......',
    '.....#..#.......',
    '................',
  ],
  'down_1': [
    '................',
    '................',
    '.....####.......',
    '....#@@@@#......',
    '...#@@@@@@#.....',
    '...#oO##Oo#.....',
    '...#oooooo#.....',
    '....#oooo#......',
    '....##@@##......',
    '...#oooooo#.....',
    '...#o#oo#o#.....',
    '....#oooo#......',
    '....#@@@@#......',
    '...#@@..@@#.....',
    '...#......#.....',
    '................',
  ],
  'down_2': [
    '................',
    '................',
    '.....####.......',
    '....#@@@@#......',
    '...#@@@@@@#.....',
    '...#oO##Oo#.....',
    '...#oooooo#.....',
    '....#oooo#......',
    '....##@@##......',
    '...#oooooo#.....',
    '...#o#oo#o#.....',
    '....#oooo#......',
    '....#@@@@#......',
    '....#@@@@#......',
    '.....#..#.......',
    '................',
  ],
  'up_0': [
    '................',
    '................',
    '.....####.......',
    '....#@@@@#......',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '....#@@@@#......',
    '....##@@##......',
    '...#oooooo#.....',
    '...#o#oo#o#.....',
    '....#oooo#......',
    '....#@@@@#......',
    '....#@@@@#......',
    '.....#..#.......',
    '................',
  ],
  'up_1': [
    '................',
    '................',
    '.....####.......',
    '....#@@@@#......',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '....#@@@@#......',
    '....##@@##......',
    '...#oooooo#.....',
    '...#o#oo#o#.....',
    '....#oooo#......',
    '....#@@@@#......',
    '...#@@..@@#.....',
    '...#......#.....',
    '................',
  ],
  'up_2': [
    '................',
    '................',
    '.....####.......',
    '....#@@@@#......',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '...#@@@@@@#.....',
    '....#@@@@#......',
    '....##@@##......',
    '...#oooooo#.....',
    '...#o#oo#o#.....',
    '....#oooo#......',
    '....#@@@@#......',
    '....#@@@@#......',
    '.....#..#.......',
    '................',
  ],
  'left_0': [
    '................',
    '................',
    '....####........',
    '...#@@@@#.......',
    '..#@@@@@#.......',
    '..#Oo@@@#.......',
    '..#oooo#........',
    '...#ooo#........',
    '...##@@##.......',
    '..#oooooo#......',
    '..#o#oooo#......',
    '...#oooo#.......',
    '...#@@@@#.......',
    '...#@@@@#.......',
    '....#..#........',
    '................',
  ],
  'left_1': [
    '................',
    '................',
    '....####........',
    '...#@@@@#.......',
    '..#@@@@@#.......',
    '..#Oo@@@#.......',
    '..#oooo#........',
    '...#ooo#........',
    '...##@@##.......',
    '..#oooooo#......',
    '..#o#oooo#......',
    '...#oooo#.......',
    '...#@@@@#.......',
    '..#@@..@@#......',
    '..#......#......',
    '................',
  ],
  'left_2': [
    '................',
    '................',
    '....####........',
    '...#@@@@#.......',
    '..#@@@@@#.......',
    '..#Oo@@@#.......',
    '..#oooo#........',
    '...#ooo#........',
    '...##@@##.......',
    '..#oooooo#......',
    '..#o#oooo#......',
    '...#oooo#.......',
    '...#@@@@#.......',
    '...#@@@@#.......',
    '....#..#........',
    '................',
  ],
  'right_0': [
    '................',
    '................',
    '........####....',
    '.......#@@@@#...',
    '.......#@@@@@#..',
    '.......#@@@oO#..',
    '........#oooo#..',
    '........#ooo#...',
    '.......##@@##...',
    '......#oooooo#..',
    '......#oooo#o#..',
    '.......#oooo#...',
    '.......#@@@@#...',
    '.......#@@@@#...',
    '........#..#....',
    '................',
  ],
  'right_1': [
    '................',
    '................',
    '........####....',
    '.......#@@@@#...',
    '.......#@@@@@#..',
    '.......#@@@oO#..',
    '........#oooo#..',
    '........#ooo#...',
    '.......##@@##...',
    '......#oooooo#..',
    '......#oooo#o#..',
    '.......#oooo#...',
    '.......#@@@@#...',
    '......#@@..@@#..',
    '......#......#..',
    '................',
  ],
  'right_2': [
    '................',
    '................',
    '........####....',
    '.......#@@@@#...',
    '.......#@@@@@#..',
    '.......#@@@oO#..',
    '........#oooo#..',
    '........#ooo#...',
    '.......##@@##...',
    '......#oooooo#..',
    '......#oooo#o#..',
    '.......#oooo#...',
    '.......#@@@@#...',
    '.......#@@@@#...',
    '........#..#....',
    '................',
  ],
};

// Map of NPC types to their sprite data
const NPC_SPRITE_DATA: Record<NPCSpriteType, Record<string, string[]> | null> = {
  'player': null,       // Use player sprite from tileset.ts
  'swimmer': SWIMMER_SPRITES,
  'scientist': SCIENTIST_SPRITES,
  'villain': VILLAIN_SPRITES,
  'fisher': FISHER_SPRITES,
  'shopkeeper': SHOPKEEPER_SPRITES,
  'gymleader': GYMLEADER_SPRITES,
  'diver': DIVER_SPRITES,
  'kid': KID_SPRITES,
};

function parseNPCSprite(lines: string[]): number[][] {
  const pixels: number[][] = [];
  for (let y = 0; y < 16; y++) {
    const row: number[] = [];
    const line = lines[y] || '';
    for (let x = 0; x < 16; x++) {
      const char = line[x] || '.';
      switch (char) {
        case '#': row.push(1); break; // Black outline
        case '@': row.push(2); break; // Dark (clothes/hair)
        case 'o': row.push(3); break; // Light (skin)
        case 'O': row.push(4); break; // White highlight
        default: row.push(0); break;  // Transparent
      }
    }
    pixels.push(row);
  }
  return pixels;
}

const npcSpriteCache: Map<string, number[][]> = new Map();

export function getNPCSprite(type: NPCSpriteType, direction: Direction, frame: number): number[][] | null {
  if (type === 'player') return null; // Signal to use player sprite

  const spriteData = NPC_SPRITE_DATA[type];
  if (!spriteData) return null;

  const key = `${type}_${direction}_${frame}`;

  if (!npcSpriteCache.has(key)) {
    const spriteKey = `${direction}_${frame}`;
    const data = spriteData[spriteKey] || spriteData['down_0'];
    npcSpriteCache.set(key, parseNPCSprite(data));
  }

  return npcSpriteCache.get(key)!;
}

export function drawNPC(x: number, y: number, type: NPCSpriteType, direction: Direction, frame: number): boolean {
  const sprite = getNPCSprite(type, direction, frame);
  if (!sprite) return false; // Return false to indicate player sprite should be used

  const ctx = getContext();
  const colors = [null, DMG_PALETTE.BLACK, DMG_PALETTE.DARK, DMG_PALETTE.LIGHT, DMG_PALETTE.WHITE];

  for (let row = 0; row < 16; row++) {
    for (let col = 0; col < 16; col++) {
      const colorIndex = sprite[row][col];
      if (colorIndex > 0) {
        ctx.fillStyle = colors[colorIndex]!;
        ctx.fillRect(Math.floor(x + col), Math.floor(y + row), 1, 1);
      }
    }
  }

  return true;
}
